let user_name="",password_json="",delimited_path_new="",rtf_path_new="",media_path_new="",page_path_new="",template_path_new="";const admin=document.getElementById("admin"),login=document.getElementById("admin-panel-login"),cancel=document.getElementById("cancel-btn"),submit=document.getElementById("login-btn"),close_btn=document.getElementById("close-btn");async function auth(){fetch("assets/config/app_config.json").then(e=>{if(e.ok)return e.json();throw new Error("HTTP error! Status: "+e.status)}).then(e=>{console.log("JSON Data:",e),user_name=e.username,password_json=e.password}).catch(e=>{console.error("Fetch Error:",e)})}async function readPreferencesToJS(){var e=require("fs"),t=require("os").homedir()+"\\AppData\\Local\\pref.json";try{await e.readFile(t,"utf8",(e,t)=>{e?console.log(e):(jsondata=JSON.parse(t),console.log(jsondata),e=jsondata.delimited_path,document.getElementById("delimited-path").value=e,t=jsondata.rtf_path,document.getElementById("rtf-path").value=t,e=jsondata.media_path,document.getElementById("media-path").value=e,t=jsondata.page_path,document.getElementById("page-path").value=t,e=jsondata.template_path,document.getElementById("template-path").value=e)})}catch(e){console.log(e)}}document.getElementById("admin-panel-form").style.display="none",login.style.display="none",auth(),readPreferencesToJS(),admin.addEventListener("click",function(){"none"===login.style.display&&(login.style.display="block")}),submit.addEventListener("click",function(){var e=require("indesign")["app"],t=document.getElementById("username").value,n=document.getElementById("password").value;t===user_name&&n===password_json?(document.getElementById("admin-panel-form").style.display="block",login.style.display="none"):((t=e.dialogs.add()).dialogColumns.add().staticTexts.add().staticLabel="Please enter correct username and password....",t.canCancel=!1,t.show(),t.destroy())}),cancel.addEventListener("click",function(){"block"===login.style.display&&(login.style.display="none")}),close_btn.addEventListener("click",function(){document.getElementById("admin-panel-form").style.display="none",document.getElementById("username").value=null,document.getElementById("password").value=null}),document.getElementById("delimited-btn").addEventListener("click",function(){require("uxp").storage.localFileSystem.getFolder().then(e=>{delimited_path_new=e.nativePath,document.getElementById("delimited-path").value=delimited_path_new}).catch(e=>{console.log(e),document.getElementById("folderLocation").innerText="Error selecting folder."})}),document.getElementById("rtf-btn").addEventListener("click",function(){require("uxp").storage.localFileSystem.getFolder().then(e=>{rtf_path_new=e.nativePath,document.getElementById("rtf-path").value=rtf_path_new}).catch(e=>{console.log(e),document.getElementById("folderLocation").innerText="Error selecting folder."})}),document.getElementById("media-btn").addEventListener("click",function(){require("uxp").storage.localFileSystem.getFolder().then(e=>{media_path_new=e.nativePath,document.getElementById("media-path").value=media_path_new}).catch(e=>{console.log(e),document.getElementById("folderLocation").innerText="Error selecting folder."})}),document.getElementById("page-btn").addEventListener("click",function(){require("uxp").storage.localFileSystem.getFolder().then(e=>{page_path_new=e.nativePath,document.getElementById("page-path").value=page_path_new}).catch(e=>{console.log(e),document.getElementById("folderLocation").innerText="Error selecting folder."})}),document.getElementById("template-btn").addEventListener("click",function(){require("uxp").storage.localFileSystem.getFolder().then(e=>{template_path_new=e.nativePath,document.getElementById("template-path").value=template_path_new}).catch(e=>{console.log(e),document.getElementById("folderLocation").innerText="Error selecting folder."})}),document.getElementById("save-btn").addEventListener("click",async function(){document.getElementById("admin-panel-form").style.display="none";const n={delimited_path:delimited_path_new,rtf_path:rtf_path_new,media_path:media_path_new,page_path:page_path_new,template_path:template_path_new};!async function(){var e=require("fs"),t=require("os"),t=t.homedir()+"\\AppData\\Local\\pref.json";console.log(t);try{await e.writeFile(t,JSON.stringify(n),{encoding:"utf-8"})}catch(e){console.log(e)}}()}),document.getElementById("OpenFile-form").style.display="none",document.getElementById("dak-open").addEventListener("click",function(){"none"===document.getElementById("OpenFile-form").style.display&&(document.getElementById("OpenFile-form").style.display="block")}),document.getElementById("closeOpenform").addEventListener("click",function(){"block"===document.getElementById("OpenFile-form").style.display&&(document.getElementById("OpenFile-form").style.display="none")}),document.getElementById("createFile-form").style.display="none",document.getElementById("dak-new").addEventListener("click",function(){"none"===document.getElementById("createFile-form").style.display&&(document.getElementById("createFile-form").style.display="block")}),document.getElementById("closeNewform").addEventListener("click",function(){"block"===document.getElementById("createFile-form").style.display&&(document.getElementById("createFile-form").style.display="none")});